"use strict";(self["webpackChunknvs_v5"]=self["webpackChunknvs_v5"]||[]).push([[5932],{5944:function(t,e,a){a.r(e),a.d(e,{default:function(){return F}});var s=a(4177),r=a(7179),n=a(3385),i=a(5223),o=a(4437),l=a(6035),d=a(9841),c=a(7345),u=a(6904),m=a(5057),p=a(1908),h=a(8421),f=a(92),D=a(1302),S=a(5294),g=a(6883),v=a(5234),x=a(5251),A=function(){var t=this,e=t._self._c;return e("div",[e(l.Z,[e(S.Z,[e(o.Z,{attrs:{cols:"12"}},[e(n.Z,{staticClass:"mx-auto",attrs:{"max-width":"650"}},[e(u.Z,[e(i.EB,[e("span",{staticClass:"text-h4 text-md-h3"},[t._v("Relatório de Lançamentos")])]),e(i.ZB,[e(l.Z,[e(S.Z,{attrs:{justify:"center"}},[e(o.Z,{attrs:{cols:"12",sm:"6",md:"12"}},[e(s.Z,{staticClass:"grey-label",attrs:{items:t.companies,color:"blue",outlined:"","hide-details":"",label:"Empresa","prepend-icon":"mdi-office-building-outline","item-text":"EMPRESA","item-value":"EMPRESA"},scopedSlots:t._u([{key:"no-data",fn:function(){return[e(p.Z,[e(h.V9,[t._v(" Nenhum item encontrado "),e("br"),e("br"),e(D.Z,{attrs:{indeterminate:"",color:"blue"}})],1)],1)]},proxy:!0}]),model:{value:t.company,callback:function(e){t.company=e},expression:"company"}})],1),e(o.Z,{attrs:{cols:"12",md:"6"}},[e(g.Z,{staticClass:"grey-label",attrs:{color:"blue","hide-details":"",items:t.aetStates,"prepend-icon":"mdi-map-marker-outline",label:"Estado",placeholder:"Selecione",outlined:""},model:{value:t.aetState,callback:function(e){t.aetState=e},expression:"aetState"}})],1),e(o.Z,{attrs:{cols:"12",md:"6"}},[e(g.Z,{staticClass:"grey-label",attrs:{color:"blue","prepend-icon":"mdi-list-status","hide-details":"",multiple:"",items:t.statusList,label:"Status",placeholder:"Selecione",outlined:""},model:{value:t.aetStatus,callback:function(e){t.aetStatus=e},expression:"aetStatus"}})],1),e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(f.Z,{staticClass:"d-flex",attrs:{"min-width":"auto","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:s}){return[e(x.Z,t._g(t._b({staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","persistent-hint":"","max-width":"100","prepend-icon":"mdi-cash",label:"Data Pagamento Taxa",hint:"Início"},model:{value:t.computedFeePaymentDateFormattedStart,callback:function(e){t.computedFeePaymentDateFormattedStart=e},expression:"computedFeePaymentDateFormattedStart"}},"v-text-field",s,!1),a))]}}])},[e(c.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.feePaymentDateStart,callback:function(e){t.feePaymentDateStart=e},expression:"feePaymentDateStart"}})],1)],1),e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(f.Z,{staticClass:"d-flex",attrs:{"min-width":"auto","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:s}){return[e(x.Z,t._g(t._b({staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","persistent-hint":"","max-width":"100",label:"Data Pagamento Taxa",hint:"Final"},model:{value:t.computedFeePaymentDateFormattedEnd,callback:function(e){t.computedFeePaymentDateFormattedEnd=e},expression:"computedFeePaymentDateFormattedEnd"}},"v-text-field",s,!1),a))]}}])},[e(c.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.feePaymentDateEnd,callback:function(e){t.feePaymentDateEnd=e},expression:"feePaymentDateEnd"}})],1)],1),e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(f.Z,{staticClass:"d-flex",attrs:{"min-width":"auto","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:s}){return[e(x.Z,t._g(t._b({staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","persistent-hint":"","max-width":"100","prepend-icon":"mdi-cash-register",label:"Data Lançamento",hint:"Início"},model:{value:t.computedRegisterDateFormattedStart,callback:function(e){t.computedRegisterDateFormattedStart=e},expression:"computedRegisterDateFormattedStart"}},"v-text-field",s,!1),a))]}}])},[e(c.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.registerDateStart,callback:function(e){t.registerDateStart=e},expression:"registerDateStart"}})],1)],1),e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(f.Z,{staticClass:"d-flex",attrs:{"min-width":"auto","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:s}){return[e(x.Z,t._g(t._b({staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","persistent-hint":"","max-width":"100",label:"Data Lançamento",hint:"Final"},model:{value:t.computedRegisterDateFormattedEnd,callback:function(e){t.computedRegisterDateFormattedEnd=e},expression:"computedRegisterDateFormattedEnd"}},"v-text-field",s,!1),a))]}}])},[e(c.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.registerDateEnd,callback:function(e){t.registerDateEnd=e},expression:"registerDateEnd"}})],1)],1)],1)],1)],1),e(i.h7,{staticClass:"mt-n10 px-10 py-5"},[e(r.Z,{attrs:{fab:"",small:"",disabled:!t.licences,loading:t.loading2},on:{click:function(e){return t.downloadPDF()}}},[e(m.Z,{attrs:{dark:"",color:"red darken-2"}},[t._v(" mdi-file-pdf-box ")])],1),e(r.Z,{attrs:{fab:"",small:"",disabled:!t.licences,loading:t.loading3},on:{click:function(e){return t.downloadXLSX("xlsx")}}},[e(m.Z,{attrs:{dark:"",color:"green darken-2"}},[t._v(" mdi-microsoft-excel ")])],1),e(v.Z),e(r.Z,{attrs:{color:"blue darken-3 white--text",loading:t.loading},on:{click:function(e){t.generateReport(),t.loading=!0}}},[t._v(" Gerar Relatório ")])],1)],1)],1)],1)],1),e(S.Z,[!0===t.showReport?e(l.Z,[e(d.Z,{attrs:{headers:t.headers,items:t.licences,"footer-props":{itemsPerPageOptions:[5,10,-1]}}})],1):t._e()],1)],1),e("vue-html2pdf",{ref:"html2Pdf",attrs:{"show-layout":!1,"enable-download":!0,"manual-pagination":!1,"paginate-elements-by-height":14001,filename:t.reportName,"pdf-quality":2,"pdf-format":"a4","pdf-orientation":"landscape","pdf-content-width":"100%"},on:{startPagination:function(e){t.loading2=!0},hasDownloaded:function(e){t.loading2=!1}}},[e("section",{attrs:{slot:"pdf-content"},slot:"pdf-content"},[!0===t.showReport?e(l.Z,[e(d.Z,{attrs:{headers:t.headers,items:t.licences,"footer-props":{itemsPerPageOptions:[-1]}}})],1):t._e()],1)]),e("table",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"exportableTable"},[e("tr",t._l(t.headers,(function(a,s){return e("th",{key:"header"+s},[t._v(" "+t._s(a.text)+" ")])})),0),t._l(t.licences,(function(a,s){return e("tr",{key:"data"+s},[e("td",[t._v(t._s(a.ID))]),e("td",[t._v(t._s(t.usDate(a.DATA)))]),e("td",[t._v(t._s(a.SOLICITANTE))]),e("td",[t._v(t._s(a.EMPRESA))]),e("td",[t._v(t._s(a.PLACA))]),e("td",[t._v(t._s(a.ESTADO))]),e("td",[t._v(t._s(a.NUMTAXA))]),e("td",[t._v(t._s(t.usDate(a.DATAPAGAMENTOTAXA)))])])}))],2)],1)},P=[],E=(a(560),a(5121)),y=a(2074),b=a(4105),T={name:"FinancialReportStaff",components:{VueHtml2pdf:y.Z},data:()=>({company:"",aetState:"",plate:"",aetStatus:"",table:"",feePaymentDateFormatted:"",registerDateFormatted:"",reportName:"",showReport:!1,licences:null,loading:!1,loading2:!1,loading3:!1,registerDateStart:new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString().substr(0,10),registerDateEnd:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),feePaymentDateStart:new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString().substr(0,10),feePaymentDateEnd:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),companies:[],aetStates:[{value:"",text:"Selecione"},{value:"FEDERAL",text:"FEDERAL"},{value:"BA",text:"Bahia"},{value:"GO",text:"Goiás"},{value:"MG",text:"Minas Gerais"},{value:"MS",text:"Mato Grosso do Sul"},{value:"PE",text:"Pernambuco"},{value:"PR",text:"Paraná"},{value:"RJ",text:"Rio de Janiero"},{value:"RS",text:"Rio Grande do Sul"},{value:"SC",text:"Santa Catarina"},{value:"SP",text:"São Paulo"},{value:"TO",text:"Tocantins"},{value:"AC",text:"Acre"},{value:"AL",text:"Alagoas"},{value:"AM",text:"Amazonas"},{value:"AP",text:"Amapá"},{value:"CE",text:"Ceará"},{value:"DF",text:"Distrito Federal"},{value:"ES",text:"Espirito Santo"},{value:"MA",text:"Maranhão"},{value:"MT",text:"Mato Grosso"},{value:"PA",text:"Pará"},{value:"PB",text:"Paraíba"},{value:"PI",text:"Piauí"},{value:"RN",text:"Rio Grande do Norte"},{value:"RO",text:"Rondônia"},{value:"RR",text:"Roraima"},{value:"SE",text:"Sergipe"}],headers:[{text:"ID",value:"ID"},{text:"Lançamento",value:"DATA"},{text:"Status",value:"SOLICITANTE"},{text:"Empresa",value:"EMPRESA"},{text:"Placa",value:"PLACA"},{text:"UF",value:"ESTADO"},{text:"Taxa",value:"NUMTAXA"},{text:"Pagamento",value:"DATAPAGAMENTOTAXA"}],statusList:[{text:"Taxa",value:"TAXA"},{text:"Não Saiu Nada",value:"Não Saiu Nada"},{text:"Emitido",value:"Emitido"}]}),computed:{computedRegisterDateFormattedStart(){return this.formatDate(this.registerDateStart)},computedRegisterDateFormattedEnd(){return this.formatDate(this.registerDateEnd)},computedFeePaymentDateFormattedStart(){return this.formatDate(this.feePaymentDateStart)},computedFeePaymentDateFormattedEnd(){return this.formatDate(this.feePaymentDateEnd)}},watch:{company(){let t=this.companies.filter((t=>t.EMPRESA===this.company));return this.plates=t,this.plates},registerDateStart(){this.registerDateFormatted=this.formatDate(this.registerDateStart)},registerDateEnd(){this.registerDateFormatted=this.formatDate(this.registerDateEnd)},feePaymentDateStart(){this.feePaymentDateFormatted=this.formatDate(this.feePaymentDateStart)},feePaymentDateEnd(){this.feePaymentDateFormatted=this.formatDate(this.feePaymentDateEnd)},licences(){return this.reportName="Relatório NVS "+this.registerDateEnd}},created(){this.fetchCompanies()},methods:{fetchCompanies(){return fetch("https://sheetdb.io/api/v1/afxq0nl1f0gvg").then((t=>t.json())).then((t=>{this.companies=t}))},formatDate(t){if(!t)return null;var[e,a,s]=t.split("-");return`${s.padStart(2,"0")}/${a.padStart(2,"0")}/${e}`},parseDate(t){if(!t)return null;const[e,a,s]=t.split("/");return`${s}${a.padStart(2,"0")}${e.padStart(2,"0")}`},usDate(t){if(!t)return null;const[e,a,s]=t.split("/");var r="00:00:28";return`${a.padStart(2,"0")}/${e.padStart(2,"0")}/${s} ${r}`},fetchLicences(){return E.Z.get("https://sheetdb.io/api/v1/afxq0nl1f0gvg")},generateReport(){this.fetchLicences().then((t=>{var e=t.data;this.$nextTick((()=>{var t=[],a=[];if(0===this.aetStatus.length)t=e.filter((t=>(t.SOLICITANTE.includes(this.aetStatus)||t.SOLICITANTE.includes(this.aetStatus))&&t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.aetState)&&this.parseDate(t.DATAPAGAMENTOTAXA)>=this.feePaymentDateStart.replace(/-/g,"")&&this.parseDate(t.DATAPAGAMENTOTAXA)<=this.feePaymentDateEnd.replace(/-/g,"")&&this.parseDate(t.DATA)>=this.registerDateStart.replace(/-/g,"")&&this.parseDate(t.DATA)<=this.registerDateEnd.replace(/-/g,"")));else for(let s=0;s<this.aetStatus.length;s++)a=e.filter((t=>(t.SOLICITANTE.includes(this.aetStatus)||t.SOLICITANTE.includes(this.aetStatus[s]))&&t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.aetState)&&this.parseDate(t.DATAPAGAMENTOTAXA)>=this.feePaymentDateStart.replace(/-/g,"")&&this.parseDate(t.DATAPAGAMENTOTAXA)<=this.feePaymentDateEnd.replace(/-/g,"")&&this.parseDate(t.DATA)>=this.registerDateStart.replace(/-/g,"")&&this.parseDate(t.DATA)<=this.registerDateEnd.replace(/-/g,""))),t.push(...a);this.licences=t,this.showReport=!0,this.loading=!1}))}))},downloadPDF(){this.$refs.html2Pdf.generatePdf()},downloadXLSX(t,e,a){var s=this.$refs.exportableTable,r=b.P6.table_to_book(s,{sheet:"Relatório"});this.loading3=!0,setTimeout((()=>(this.loading3=!1,a?b.cW(r,{bookType:t,bookSTT:!0,type:"string"}):b.NC(r,e||this.reportName+"."+(t||"xlsx")))),100)}}},Z=T,_=a(1001),R=(0,_.Z)(Z,A,P,!1,null,null,null),F=R.exports}}]);
//# sourceMappingURL=views-FinancialReportStaff.4f43ecd5.js.map